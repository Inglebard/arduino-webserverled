function sendLedData(idLed){var ledObj=ledObjs[idLed];$.ajax({url:"/led/?id="+idLed+"&r="+ledObj.r+"&g="+ledObj.g+"&b="+ledObj.b})}function sendAllLedData(){var rgbValue=hexToRgb($("#all_led_color_selector").val()),brightness=$("#all_led_brightness_selector").val();$.ajax({url:"/allleds/?r="+rgbValue.r+"&g="+rgbValue.g+"&b="+rgbValue.b})}function sendParameterData(name,value){$.ajax({url:"/parameters/?name="+name+"&value="+value})}function sendModeData(mode){$.ajax({url:"/modes/?mode="+mode})}function sendTemplateData(template){$.ajax({url:"/templates/?template="+template})}function refreshUi(){var templateLedObj='\n  <div class="ib ledObj">\n    <input type="hidden" class="ledObj_num" value="%LED_ID%">\n    <div class="ledObj_inner">\t\n      <span class="ib name">LED %LED_ID%</span>\n      <div>\t\t\t\t\t\n        <div class="ib color">\t\n          <div style="background-color:%COLOR_VALUE%" class="color_viewer color_viewer_%LED_ID%">\n          </div>\t\t\t\t\t\t\n          <input data-ledid="%LED_ID%" type="color" class="color_selector color_selector_%LED_ID%" id="color_selector_%LED_ID%" value="%COLOR_VALUE%">\n        </div>\n      </div>\t\t\t\n    </div>   \n  </div> \n  ';for(ledObj_index in $("#listing_leds").html(""),ledObjs)ledObj=ledObjs[ledObj_index],output=templateLedObj.replaceAll("%LED_ID%",ledObj_index),output=output.replaceAll("%COLOR_VALUE%","#"+rgb2hex(ledObj.r,ledObj.g,ledObj.b)),$("#listing_leds").append(output);$(".listing_leds .color_selector").change((function(){var color_viewer;$(this).siblings(".color_viewer").css("backgroundColor",$(this).val());var ledId=$(this).data("ledid"),rgbValue=hexToRgb($(this).val());ledObjs[ledId].r=rgbValue.r,ledObjs[ledId].g=rgbValue.g,ledObjs[ledId].b=rgbValue.b,sendLedData(ledId)})),$(".listing_leds .color_viewer").click((function(){var color_selector;$(this).siblings(".color_selector").trigger("click")}))}function rgb2hex(r,g,b){var hexValue="";return hexValue=((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1)}function hexToRgb(hex){var c,rgbObj={};if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex))return 3==(c=hex.substring(1).split("")).length&&(c=[c[0],c[0],c[1],c[1],c[2],c[2]]),c="0x"+c.join(""),rgbObj.r=c>>16&255,rgbObj.g=c>>8&255,rgbObj.b=255&c,rgbObj;throw new Error("Bad Hex")}$(document).ready((function(){refreshUi(),template_selector,$(".template_selector").click((function(e){var template_value;e.preventDefault(),sendTemplateData($(this).data("template"))})),$(".listing_custom_control .color_selector").change((function(){$(".color_viewer").css("backgroundColor",$(this).val()),sendAllLedData()})),$(".listing_custom_control .color_viewer").click((function(){var color_selector;$(this).siblings(".color_selector").trigger("click")})),$(".listing_custom_control .color_viewer").click((function(){var color_selector;$(this).siblings(".color_selector").trigger("click")})),$("#brightness_selector").val(init_brightness_value),$("#direction_selector").val(init_direction_value),$("#delay_selector").val(init_delay_value),$(".mode_selector").each((function(){$(this).data("real_value")==init_mode_value&&$(this).addClass("active")})),$(".mode_selector").click((function(){var mode_real_value=$(this).data("real_value");$(".mode_selector").removeClass("active"),$(this).addClass("active"),sendModeData(mode_real_value)})),$("#brightness_selector").change((function(){var brightness_value;sendParameterData("brightness",$(this).val())})),$("#direction_selector").change((function(){var direction_value;sendParameterData("direction",$(this).val())})),$("#delay_selector").change((function(){var delay_value;sendParameterData("delay",$(this).val())}))}));